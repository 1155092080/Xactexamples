(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34351,       1091]
NotebookOptionsPosition[     31952,       1040]
NotebookOutlinePosition[     32364,       1057]
CellTagsIndexPosition[     32321,       1054]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"g", "=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", 
        RowBox[{"f", "[", "r", "]"}]}], "0", "0", "0"},
      {"0", 
       FractionBox["1", 
        RowBox[{"f", "[", "r", "]"}]], "0", "0"},
      {"0", "0", 
       SuperscriptBox["r", "2"], "0"},
      {"0", "0", "0", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            ShowAutoStyles->False,
            AutoSpacing->False],
           Sin,
           Editable->False], "[", "\[Theta]", "]"}], "2"]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coord", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gUU", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "g", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dg", "=", 
   RowBox[{"Det", "[", "g", "]"}]}], ";"}], "\n", 
 RowBox[{"KG", "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"-", "dg"}], "]"}]], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"-", "dg"}], "]"}], " ", 
         RowBox[{"gUU", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[CapitalPhi]", "[", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
            "]"}], ",", 
           RowBox[{"coord", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"coord", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.939003994886848*^9, 3.939004005419097*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"04cb9ceb-77aa-4f92-bfbe-21817f5efc32"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"f", "[", "r", "]"}]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      RowBox[{"f", "[", "r", "]"}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.939003992527522*^9, 3.9390040060216246`*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"44d2ad1d-e198-4cfe-8bfb-ff43e3e31fb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["r", "2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["\[CapitalPhi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[CapitalPhi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], 
     "+", 
     RowBox[{
      SuperscriptBox["\[CapitalPhi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
     "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"f", "[", "r", "]"}]}], "+", 
           RowBox[{"r", " ", 
            RowBox[{
             SuperscriptBox["f", "\[Prime]",
              MultilineFunction->None], "[", "r", "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[CapitalPhi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
          "]"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[CapitalPhi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
          "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[CapitalPhi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
   RowBox[{"f", "[", "r", "]"}]]}]], "Output",
 CellChangeTimes->{{3.939003992527522*^9, 3.93900400682907*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"cee1b209-f018-4b41-a2c0-7d4999d623d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KG1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "r"}], " ", 
     RowBox[{"f", "[", "r", "]"}], "KG"}], "/.", 
    RowBox[{"\[CapitalPhi]", "->", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "}"}], 
       ",", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"t", ",", "r"}], "]"}]}], "r"]}], "]"}]}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{
  3.9390040247175646`*^9, {3.9390041296864543`*^9, 3.939004131747498*^9}, {
   3.9390041759505825`*^9, 3.939004178445468*^9}, {3.939004491371563*^9, 
   3.93900449232225*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"73b2c06d-d604-46af-ad9d-2bf6ecbbd565"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"f", "[", "r", "]"}], " ", 
    RowBox[{
     SuperscriptBox["f", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"t", ",", "r"}], "]"}], "-", 
      RowBox[{"r", " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "r"], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"f", "[", "r", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "r"}], "]"}]}]], "Output",
 CellChangeTimes->{3.939004033192208*^9, 3.939004133956125*^9, 
  3.9390041800388107`*^9, 3.9390045139107857`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"0a984dcf-32ba-47eb-91a8-af615113125f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KG2", "=", 
  RowBox[{
   RowBox[{"KG1", "/.", 
    RowBox[{"f", "->", 
     RowBox[{"(", 
      RowBox[{"r", "\[Function]", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", "M"}], "r"]}]}], ")"}]}]}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.93900407557967*^9, 3.9390040841896453`*^9}, {
  3.939004431278283*^9, 3.9390044350900335`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"8e12fdea-d681-411f-b448-6654dcee52c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"4", " ", 
     SuperscriptBox["M", "2"], " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], 
    SuperscriptBox["r", "4"]]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "3"]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["M", "2"], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "3"]], "-", 
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "-", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "2"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "r"}], "]"}], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["M", "2"], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"4", " ", "M", " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"], "+", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "r"}], "]"}]}]], "Output",
 CellChangeTimes->{3.939004085046343*^9, 3.9390041359404006`*^9, 
  3.9390041859608903`*^9, 3.9390044356321735`*^9, 3.9390045153617725`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"38376cf6-dc0f-4f95-bf0e-a493e5e933ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KG2", "/.", 
       RowBox[{"\[Phi]", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r"}], "}"}], ",", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{
            RowBox[{"t1", "[", "t", "]"}], ",", 
            RowBox[{"x1", "[", "r", "]"}]}], "]"}]}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"t1", "[", "t", "]"}], "->", "t1"}]}], "/.", 
     RowBox[{
      RowBox[{"x1", "[", "r", "]"}], "->", "x1"}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "i_", "]"}], "[", "t1", "]"}], "[", "t", 
      "]"}], ":>", 
     RowBox[{"D", "[", 
      RowBox[{
       FractionBox["t", 
        RowBox[{"4", "M"}]], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "i"}], "}"}]}], "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", "i_", "]"}], "[", "x1", "]"}], "[", "r", 
     "]"}], ":>", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", "M"}]], 
       RowBox[{"(", 
        RowBox[{"r", "+", 
         RowBox[{"2", "M", " ", 
          RowBox[{"Log", "[", 
           RowBox[{
            FractionBox["r", 
             RowBox[{"2", "M"}]], "-", "1"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "i"}], "}"}]}], "]"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.9390047417448606`*^9, 3.939004747548773*^9}, 
   3.93900479156376*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"b7d29a87-2441-4fe8-b989-b54964d6f505"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"t1", ",", "x1"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t1", ",", "x1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t1", ",", "x1"}], "]"}]}], 
   RowBox[{"16", " ", 
    SuperscriptBox["M", "2"]}]]}]], "Output",
 CellChangeTimes->{3.9390047491521864`*^9, 3.939004797296355*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"ab28a6c7-d1fb-4a56-a50a-c962f101c455"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KG1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        RowBox[{"f", "[", "r", "]"}], "KG"}], "/.", 
       RowBox[{"\[CapitalPhi]", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
           "}"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{" ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"t", ",", "r"}], "]"}]}], "r"], 
           RowBox[{"SphericalHarmonicY", "[", 
            RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
            "]"}]}]}], "]"}]}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"KG2", "=", 
    RowBox[{
     RowBox[{
      FractionBox["KG1", 
       RowBox[{"SphericalHarmonicY", "[", 
        RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]], 
      "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l", "->", "10"}], ",", 
        RowBox[{"m", "->", "10"}]}], "}"}]}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939004991219141*^9, 3.939004992357821*^9}, {
   3.939005038727657*^9, 3.939005054118639*^9}, 3.9390051367488203`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"8d756042-0a6f-4b9e-8682-ccba50bd335d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "r", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"110", "+", 
         RowBox[{"r", " ", 
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
      SuperscriptBox["r", "2"]], "-", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "r"}], "]"}]}]], "Output",
 CellChangeTimes->{3.939005039783448*^9, 3.9390050837290916`*^9, 
  3.939005139013487*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"4fb28b1b-996c-44bb-9ad3-baa17da19460"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KG2", "=", 
  RowBox[{
   RowBox[{"KG2", "-", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", "r", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"110", "+", 
         RowBox[{"r", " ", 
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
      SuperscriptBox["r", "2"]], 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", "r", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l", 
          RowBox[{"(", 
           RowBox[{"l", "+", "1"}], ")"}]}], "+", 
         RowBox[{"r", " ", 
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
      SuperscriptBox["r", "2"]], 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}]}], "//", "FullSimplify"}]}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"56d72028-1a0e-4531-a9f2-fdcd5f22fae8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "r", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"t", ",", "r"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"l", "+", 
         SuperscriptBox["l", "2"], "+", 
         RowBox[{"r", " ", 
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
      SuperscriptBox["r", "2"]], "-", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "r"}], "]"}]}]], "Output",
 CellChangeTimes->{3.939005175986711*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"39306c93-2815-4a65-847c-2d808a50a1ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KG3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KG2", "/.", 
         RowBox[{"f", "->", 
          RowBox[{"(", 
           RowBox[{"r", "\[Function]", 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{"2", "M"}], "r"]}]}], ")"}]}]}], "/.", 
        RowBox[{"\[Phi]", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r"}], "}"}], ",", 
           RowBox[{"\[Phi]", "[", 
            RowBox[{
             RowBox[{"t1", "[", "t", "]"}], ",", 
             RowBox[{"x1", "[", "r", "]"}]}], "]"}]}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"t1", "[", "t", "]"}], "->", "t1"}]}], "/.", 
      RowBox[{
       RowBox[{"x1", "[", "r", "]"}], "->", "x1"}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "i_", "]"}], "[", "t1", "]"}], "[", "t", 
       "]"}], ":>", 
      RowBox[{"D", "[", 
       RowBox[{
        FractionBox["t", 
         RowBox[{"4", "M"}]], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "i"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "i_", "]"}], "[", "x1", "]"}], "[", "r", 
      "]"}], ":>", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", "M"}]], 
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"2", "M", " ", 
           RowBox[{"Log", "[", 
            RowBox[{
             FractionBox["r", 
              RowBox[{"2", "M"}]], "-", "1"}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "i"}], "}"}]}], "]"}]}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.9390052019619894`*^9, 3.939005231318946*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"380f653d-7f46-4dec-ab08-635d4c3c4008"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", "r"}]}], ")"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"t1", ",", "x1"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t1", ",", "x1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t1", ",", "x1"}], "]"}]}], 
   RowBox[{"16", " ", 
    SuperscriptBox["M", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.939005204791772*^9, 3.9390052321391463`*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"de2ed875-660e-4064-ada6-21b14c643482"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KG4", "=", 
  RowBox[{"KG2", "+", 
   RowBox[{"r", " ", 
    RowBox[{"f", "[", "r", "]"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["fa", "2"], 
        SuperscriptBox["\[Mu]", "2"], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox[
             RowBox[{" ", 
              RowBox[{"\[Phi]", "[", 
               RowBox[{"t", ",", "r"}], "]"}]}], "r"], 
            RowBox[{
             RowBox[{"SphericalHarmonicY", "[", 
              RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
              "]"}], "/", "fa"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"dc", "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{" ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"t", ",", "r"}], "]"}]}], "r"], 
           RowBox[{"SphericalHarmonicY", "[", 
            RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
            "]"}]}], ",", "t"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9390053405541334`*^9, 3.9390053507873755`*^9}, 
   3.9390055005704627`*^9, {3.9390055354341383`*^9, 3.939005551168186*^9}, {
   3.939005595533499*^9, 3.939005658760714*^9}, {3.9390057330513763`*^9, 
   3.9390057840283947`*^9}, {3.9390058205073137`*^9, 
   3.9390058332781153`*^9}, {3.93900644323866*^9, 3.939006443665392*^9}, {
   3.9390065100044537`*^9, 3.9390065221868877`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"911709c6-7c9b-42d7-96d7-f03424b85408"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "r", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"t", ",", "r"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", 
          SuperscriptBox["l", "2"], "+", 
          RowBox[{"r", " ", 
           RowBox[{
            SuperscriptBox["f", "\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], ")"}], 
      "/", 
      SuperscriptBox["r", "2"]}], "-", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r", " ", 
     RowBox[{"f", "[", "r", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["fa", "2"], " ", 
        SuperscriptBox["\[Mu]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SphericalHarmonicY", "[", 
               RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
               "]"}], " ", 
              RowBox[{"\[Phi]", "[", 
               RowBox[{"t", ",", "r"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"fa", " ", "r"}], ")"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dc", " ", 
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
           "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"t", ",", "r"}], "]"}]}], ")"}], "/", "r"}]}], ")"}]}], 
    ")"}], "/", 
   RowBox[{"SphericalHarmonicY", "[", 
    RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t", ",", "r"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.9390056830931387`*^9, 3.93900573965849*^9, {3.9390058242872715`*^9, 
   3.9390058359829483`*^9}, 3.9390064732205687`*^9, {3.93900651134297*^9, 
   3.939006536124349*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"5918b562-fe3a-4fca-b6da-22de0abfe24b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KG4", "/.", 
        RowBox[{"f", "->", 
         RowBox[{"(", 
          RowBox[{"r", "\[Function]", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "M"}], ")"}], "/", "r"}]}]}], ")"}]}]}], "/.", 
       RowBox[{"\[Phi]", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r"}], "}"}], ",", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{
            RowBox[{"t1", "[", "t", "]"}], ",", 
            RowBox[{"x1", "[", "r", "]"}]}], "]"}]}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"t1", "[", "t", "]"}], "->", "t1"}]}], "/.", 
     RowBox[{
      RowBox[{"x1", "[", "r", "]"}], "->", "x1"}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "i_", "]"}], "[", "t1", "]"}], "[", "t", 
      "]"}], ":>", 
     RowBox[{"D", "[", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "i"}], "}"}]}], "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", "i_", "]"}], "[", "x1", "]"}], "[", "r", 
     "]"}], ":>", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r", "+", 
        RowBox[{"2", "M", " ", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"r", "/", 
            RowBox[{"(", 
             RowBox[{"2", "M"}], ")"}]}], "-", "1"}], "]"}]}]}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "i"}], "}"}]}], "]"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.9390058505486627`*^9, 3.939005856032544*^9}, {
  3.9390068370068274`*^9, 3.939006851907649*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"426c4d03-f45d-474a-833a-2693ed6af15f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["fa", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["\[Mu]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"SphericalHarmonicY", "[", 
          RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}],
          " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"t1", ",", "x1"}], "]"}]}], 
        RowBox[{"fa", " ", "r"}]], "]"}]}], ")"}]}], 
   RowBox[{"SphericalHarmonicY", "[", 
    RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", "r"}]}], ")"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"t1", ",", "x1"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "-", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "2"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t1", ",", "x1"}], "]"}], "+", 
  FractionBox[
   RowBox[{"dc", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t1", ",", "x1"}], "]"}]}], "r"], "+", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"t1", ",", "x1"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.939005864599908*^9, 3.9390064809870453`*^9, {3.93900653031284*^9, 
   3.939006554712736*^9}, 3.939006878291526*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"118e6c24-f815-43be-a8e5-8d625dbaab4a"]
}, Open  ]]
},
WindowSize->{88, 616},
WindowMargins->{{Automatic, -6617}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2022\:5e742\:67084\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"73f752ae-98d7-477c-9a1e-a9df94296e7f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2526, 77, 307, "Input",ExpressionUUID->"04cb9ceb-77aa-4f92-bfbe-21817f5efc32"],
Cell[3109, 101, 782, 23, 61, "Output",ExpressionUUID->"44d2ad1d-e198-4cfe-8bfb-ff43e3e31fb1"],
Cell[3894, 126, 2804, 82, 110, "Output",ExpressionUUID->"cee1b209-f018-4b41-a2c0-7d4999d623d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6735, 213, 799, 22, 73, "Input",ExpressionUUID->"73b2c06d-d604-46af-ad9d-2bf6ecbbd565"],
Cell[7537, 237, 1285, 42, 63, "Output",ExpressionUUID->"0a984dcf-32ba-47eb-91a8-af615113125f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8859, 284, 473, 12, 73, "Input",ExpressionUUID->"8e12fdea-d681-411f-b448-6654dcee52c8"],
Cell[9335, 298, 2237, 77, 63, "Output",ExpressionUUID->"38376cf6-dc0f-4f95-bf0e-a493e5e933ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11609, 380, 1656, 53, 141, "Input",ExpressionUUID->"b7d29a87-2441-4fe8-b989-b54964d6f505"],
Cell[13268, 435, 997, 33, 63, "Output",ExpressionUUID->"ab28a6c7-d1fb-4a56-a50a-c962f101c455"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14302, 473, 1436, 39, 194, "Input",ExpressionUUID->"8d756042-0a6f-4b9e-8682-ccba50bd335d"],
Cell[15741, 514, 1510, 49, 60, "Output",ExpressionUUID->"4fb28b1b-996c-44bb-9ad3-baa17da19460"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17288, 568, 1081, 33, 76, "Input",ExpressionUUID->"56d72028-1a0e-4531-a9f2-fdcd5f22fae8"],
Cell[18372, 603, 1500, 49, 70, "Output",ExpressionUUID->"39306c93-2815-4a65-847c-2d808a50a1ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19909, 657, 1934, 60, 141, "Input",ExpressionUUID->"380f653d-7f46-4dec-ab08-635d4c3c4008"],
Cell[21846, 719, 1161, 39, 63, "Output",ExpressionUUID->"de2ed875-660e-4064-ada6-21b14c643482"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23044, 763, 1747, 43, 73, "Input",ExpressionUUID->"911709c6-7c9b-42d7-96d7-f03424b85408"],
Cell[24794, 808, 3075, 94, 3426, "Output",ExpressionUUID->"5918b562-fe3a-4fca-b6da-22de0abfe24b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27906, 907, 1848, 57, 3865, "Input",ExpressionUUID->"426c4d03-f45d-474a-833a-2693ed6af15f"],
Cell[29757, 966, 2179, 71, 141, "Output",ExpressionUUID->"118e6c24-f815-43be-a8e5-8d625dbaab4a"]
}, Open  ]]
}
]
*)

